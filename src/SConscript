Import('env', 'modconfig')

# Source files
files = ('mdt_exp_transform.c', 'mdt_linear_transform.c', 'util.c',
         'mdt_inverse_transform.c', 'mdt_log_transform.c', 'mdt_offset_min.c',
         'mdt_smooth.c', 'mdt_close.c', 'mdt_entropy_hx.c', 'mdt_write.c')

# Build a Windows DLL exports file from the public header file:
env.W32Def('libmdt.def', 'mdt.h')

# Build the shared library
lib = env.SharedLibrary('mdt', files, WIN32DEFPREFIX='lib', WIN32_INSERT_DEF=1,
                        WINDOWSEXPPREFIX='lib',
                        CPPPATH=modconfig['include'],
                        LIBS=modconfig['libs']+['m'],
                        LIBPATH=modconfig['libpath'])

# Install the shared library
libinst = env.Install(modconfig['libinstall'], lib)
env.Alias('install', libinst)
